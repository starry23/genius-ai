(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f4e51c4"],{"027b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_warp"},[a("div",{staticClass:"page_list-head"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addRole}},[e._v("新增角色")]),a("div",{staticClass:"searchBox"},[a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{clearable:"",placeholder:"请选择角色类型"},model:{value:e.paramsObj.roleType,callback:function(t){e.$set(e.paramsObj,"roleType",t)},expression:"paramsObj.roleType"}},e._l(e.roleTypeList,(function(e){return a("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})})),1),a("el-input",{staticStyle:{width:"65%"},attrs:{clearable:"",placeholder:"请输入角色名称"},model:{value:e.paramsObj.roleName,callback:function(t){e.$set(e.paramsObj,"roleName",t)},expression:"paramsObj.roleName"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")])],1)],1),a("div",{staticClass:"content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{height:"80vh",data:e.tableData}},[a("el-table-column",{attrs:{label:"序号",type:"index"}}),e._l(e.tableColumnList,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label}})})),a("el-table-column",{attrs:{label:"角色图标",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticClass:"roleImgIcon",attrs:{src:e.row.fullUrl,alt:""}})]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.edit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.deleteRoleFn(t.row)}}},[e._v("删除")])]}}])})],2),a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":e.paramsObj.current,"page-sizes":[10,20,50,100],"page-size":e.paramsObj.size,layout:"total, sizes, prev, pager, next",total:e.paramsObj.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("addorEdit",{ref:"addorEditRef",attrs:{getAiRolesListFn:e.getAiRolesListFn}})],1)},l=[],o=a("c7eb"),s=a("1da1"),i=(a("d3b7"),a("159b"),a("7db0"),a("fb6a"),a("b775"));function n(e){return Object(i["a"])({url:"/api/manager/saveOrUpdateAiRole",method:"post",data:e})}function c(e){return Object(i["a"])({url:"/api/manager/aiRoles",method:"get",params:e})}function p(e){return Object(i["a"])({url:"/api/manager/aiRole/".concat(e),method:"DELETE"})}function u(){return Object(i["a"])({url:"/api/dict/roleType",method:"get"})}var m=[{prop:"roleTypeNameCn",label:"角色类型"},{prop:"roleName",label:"角色名称"},{prop:"roleDesc",label:"角色描述"},{prop:"abbreviationPrompt",label:"提示词"}],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"destroy-on-close":!0,title:e.rowData?"编辑角色":"新建角色",visible:e.dialogVisible,width:"550px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"角色类型",prop:"roleType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色类型"},model:{value:e.form.roleType,callback:function(t){e.$set(e.form,"roleType",t)},expression:"form.roleType"}},e._l(e.roleTypeList,(function(e){return a("el-option",{key:e.key,attrs:{value:e.key,label:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),a("el-form-item",{attrs:{label:"角色图标(jpg或png)",prop:"imageUrl"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{name:"imageUrl",data:e.uploadFileParams,"file-list":e.fileList,multiple:!1,action:e.uploadUrl,"before-upload":e.beforeUpload,"on-remove":e.handleRemove,"on-success":e.handlerSuccess,"on-change":e.uploadFile,accept:"image/jpg,image/jpeg,image/png,image/svg"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e.previewImgUrl||e.form.fullUrl?a("img",{staticClass:"el-upload--picture",attrs:{src:e.previewImgUrl||e.form.fullUrl}}):e._e()],1)],1),a("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入角色描述"},model:{value:e.form.roleDesc,callback:function(t){e.$set(e.form,"roleDesc",t)},expression:"form.roleDesc"}})],1),a("el-form-item",{attrs:{label:"提示词",prop:"prompt"}},[a("el-input",{attrs:{rows:"5",type:"textarea",placeholder:"请输入提示词"},model:{value:e.form.prompt,callback:function(t){e.$set(e.form,"prompt",t)},expression:"form.prompt"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},f=[],b=(a("e9c4"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),{props:["getAiRolesListFn"],data:function(){return{uploadFileParams:{file:"",viewType:2},previewImgUrl:"",uploadUrl:"/api/upload/file",fileList:[],roleTypeList:[],rowData:null,dialogVisible:!1,form:{roleName:"",roleDesc:"",prompt:"",roleType:"",imageUrl:""},rules:{roleName:[{required:!0,message:"角色名称不能为空"}],roleDesc:[{required:!0,message:"角色描述不能为空"}],prompt:[{required:!0,message:"提示词不能为空"}],roleType:[{required:!0,message:"角色类型不能为空"}],imageUrl:[{required:!1,message:"角色图片不能为空"}]}}},methods:{getPage:function(e){this.dialogVisible=!0,this.form={roleName:"",roleDesc:"",prompt:"",roleType:"",imageUrl:""},this.previewImgUrl="",e&&(this.rowData=e,console.log(this.rowData,"this.rowData"),this.form=JSON.parse(JSON.stringify(e))),this.getAiRoleTypeFn()},uploadFile:function(e){this.previewImgUrl=URL.createObjectURL(e.raw)},handlerSuccess:function(e){200===e.code?(this.form.imageUrl=e.result.path,this.$message({type:"success",message:"图片上传成功"})):this.$message({type:"error",message:e.message})},handleRemove:function(){this.fileList=[],this.form.imageUrl="",this.previewImgUrl=""},beforeUpload:function(e){return this.uploadFileParams.file=e,!0},submitUpload:function(){this.$refs.upload.submit()},getAiRoleTypeFn:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u();case 3:a=t.sent,200===a.code&&(e.roleTypeList=a.result||[]),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},handleClose:function(){this.dialogVisible=!1},saveOrUpdateFn:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n(e.form);case 3:a=t.sent,200===a.code?(e.$message({type:"success",message:"操作成功"}),e.handleClose(),e.getAiRolesListFn()):e.$message({type:"error",message:a.message}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},submit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.saveOrUpdateFn()}))}}}),g=b,h=(a("5245"),a("2877")),v=Object(h["a"])(g,d,f,!1,null,"3d368d58",null),y=v.exports,w={data:function(){return{tableColumnList:m,tableData:[],roleTypeList:[],paramsObj:{size:10,current:1,total:0,roleName:"",roleType:""}}},components:{addorEdit:y},methods:{getAiRoleTypeFn:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u();case 3:a=t.sent,200===a.code&&(e.roleTypeList=a.result||[],e.getAiRolesListFn()),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},search:function(){this.paramsObj.current=1,this.paramsObj.size=10,this.getAiRolesListFn()},deleteRoleFn:function(e){var t=this;this.$confirm("此操作将永久删除配置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){p(e.id).then((function(e){200===e.code?(t.$message({type:"success",message:"删除成功!"}),t.getAiRolesListFn()):t.$message({type:"error",message:e.message})}))}))},getAiRolesListFn:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a,r,l,s;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c({size:e.paramsObj.size,current:e.paramsObj.current,roleName:e.paramsObj.roleName,roleType:e.paramsObj.roleType});case 3:a=t.sent,200===a.code&&(s=(null===(r=a.result)||void 0===r?void 0:r.records)||[],s.forEach((function(t){var a;t.roleTypeNameCn=null===(a=e.roleTypeList.find((function(e){return e.key===t.roleType})))||void 0===a?void 0:a.value,t.prompt.length>15&&(t.abbreviationPrompt=t.prompt.slice(0,15)+"...")})),e.tableData=s,e.paramsObj.total=null===(l=a.result)||void 0===l?void 0:l.total),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},handleSizeChange:function(e){this.paramsObj.size=e,this.getAiRolesListFn()},handleCurrentChange:function(e){this.paramsObj.current=e,this.getAiRolesListFn()},addRole:function(){this.$refs.addorEditRef.getPage()},edit:function(e){this.$refs.addorEditRef.getPage(e)}},mounted:function(){this.getAiRoleTypeFn()}},O=w,j=(a("5c2f"),Object(h["a"])(O,r,l,!1,null,"7b29a59f",null));t["default"]=j.exports},"11a5":function(e,t,a){},5245:function(e,t,a){"use strict";a("e9a8")},"5c2f":function(e,t,a){"use strict";a("11a5")},"7db0":function(e,t,a){"use strict";var r=a("23e7"),l=a("b727").find,o=a("44d2"),s="find",i=!0;s in[]&&Array(1)[s]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{find:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},e9a8:function(e,t,a){}}]);